<!DOCTYPE html>
<html lang="ja">
  <head>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MCMW688T');</script>
<!-- End Google Tag Manager -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ウィジェットテスト</title>
    <style>
      html,
      body {
        height: 100%;
        margin: 0;
      }
      .visual-fullscreen {
        position: fixed;
        inset: 0;
        /* 下層: グラデーション, 上層: グリッド */
        background: linear-gradient(135deg, #0ea5e9, #8b5cf6),
          linear-gradient(
            to bottom,
            rgba(255, 255, 255, 0.12) 1px,
            transparent 1px
          ),
          linear-gradient(
            to right,
            rgba(255, 255, 255, 0.12) 1px,
            transparent 1px
          );
        background-size: auto, 24px 24px, 24px 24px;
        background-attachment: fixed;
        z-index: -1;
      }
      .viewport-debug {
        position: fixed;
        top: 8px;
        left: 8px;
        z-index: 9999;
        pointer-events: none;
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", monospace;
        color: #fff;
      }
      .viewport-debug .panel {
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(6px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        padding: 10px 12px;
        line-height: 1.4;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.25);
      }
      .viewport-debug .label {
        opacity: 0.8;
      }
      .viewport-debug .value {
        font-weight: 700;
      }
      .demo-wrap {
        max-width: 1200px;
        margin: 24px auto 8px;
        padding: 0 16px;
        color: #fff;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.25);
      }
      .demo-wrap h2 {
        margin: 0 0 12px;
        font-size: 20px;
      }
      .demo-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 12px;
      }
      .demo-item {
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 10px;
        padding: 12px;
        aspect-ratio: 4 / 3;
        color: #fff;
        font-weight: 700;
        box-shadow: 0 4px 14px rgba(0, 0, 0, 0.25);
      }
      .demo-item:nth-child(6n + 1) {
        background: linear-gradient(135deg, #06b6d4, #3b82f6);
      }
      .demo-item:nth-child(6n + 2) {
        background: linear-gradient(135deg, #22c55e, #84cc16);
      }
      .demo-item:nth-child(6n + 3) {
        background: linear-gradient(135deg, #f97316, #f59e0b);
      }
      .demo-item:nth-child(6n + 4) {
        background: linear-gradient(135deg, #ec4899, #a855f7);
      }
      .demo-item:nth-child(6n + 5) {
        background: linear-gradient(135deg, #06b6d4, #10b981);
      }
      .demo-item:nth-child(6n + 6) {
        background: linear-gradient(135deg, #3b82f6, #a855f7);
      }
      .demo-item .js-box-size {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", monospace;
        letter-spacing: 0.2px;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MCMW688T"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    <div class="visual-fullscreen"></div>
    <section class="demo-wrap">
      <h2>レスポンシブボックス</h2>
      <div class="demo-grid">
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
        <div class="demo-item"><span class="js-box-size">-</span></div>
      </div>
    </section>
    <div class="viewport-debug">
      <div class="panel">
        <div>
          <span class="label">inner</span>:
          <span id="vv-inner" class="value">-</span>
        </div>
        <div>
          <span class="label">visualViewport</span>:
          <span id="vv-visual" class="value">-</span>
        </div>
        <div>
          <span class="label">DPR</span>:
          <span id="vv-dpr" class="value">-</span> /
          <span class="label">orientation</span>:
          <span id="vv-orientation" class="value">-</span>
        </div>
      </div>
    </div>
    <h1>AIチャットウィジェットテスト</h1>
    <p>このページにはAIチャットウィジェットが埋め込まれています。</p>

    <h2>テスト項目</h2>
    <ul>
      <li>✅ ウィジェットが正常に表示される</li>
      <li>✅ PC版でウィジェットの高さが calc(100dvh - 90px) になっている</li>
      <li>✅ チャットウィンドウのタイトル部に閉じるボタン（×）が表示される</li>
      <li>✅ 閉じるボタンをクリックするとチャットウィンドウが閉じる</li>
      <li>✅ フローティングボタンをクリックするとチャットウィンドウが開く</li>
    </ul>

    <h2>デバッグ機能</h2>
    <button onclick="window.MastraAiChatWidget?.showProfileForm()" style="padding: 10px 20px; font-size: 16px; cursor: pointer; background: #6366F1; color: white; border: none; border-radius: 8px;">
      プロフィールフォームを表示
    </button>
    <p style="color: #666; font-size: 14px; margin-top: 8px;">
      ※ Marketo Forms 2.0 API連携をテストするには、このボタンでフォームを表示し、メールアドレスを入力して送信してください。
    </p>
    <!-- Marketo Munchkin トラッキングコード（Forms 2.0 APIとの連携に必要） -->
    <script type="text/javascript">
    (function() {
      var didInit = false;
      function initMunchkin() {
        if(didInit === false) {
          didInit = true;
          Munchkin.init('406-PFO-715');
        }
      }
      var s = document.createElement('script');
      s.type = 'text/javascript';
      s.async = true;
      s.src = 'https://munchkin.marketo.net/munchkin.js';
      s.onreadystatechange = function() {
        if (this.readyState == 'complete' || this.readyState == 'loaded') {
          initMunchkin();
        }
      };
      s.onload = initMunchkin;
      document.getElementsByTagName('head')[0].appendChild(s);
    })();
    </script>

    <!-- Marketo Forms 2.0 スクリプト（ベースURL自動検出用） -->
    <script src="//lp.mazrica.com/js/forms2/js/forms2.min.js"></script> <form id="mktoForm_4525"></form> <script>MktoForms2.loadForm("//lp.mazrica.com", "406-PFO-715", 4525);</script>

    <!-- seed.tsのANYWHERE_WIDGET_*と一致させている -->
    <script
      async
      src="https://rc-api.dev.agent.dealenablement.com/widget/cbfb652b-0085-47bd-9092-113f319638b0/1dfec218-02d0-4906-9213-59b3b85a28eb/script.js"
    ></script>
    <script>
      (function () {
        const round = (n) => Math.round(n);

        const getOrientation = () => {
          if (screen.orientation && screen.orientation.type) {
            return screen.orientation.type;
          }
          const iw = window.innerWidth;
          const ih = window.innerHeight;
          return iw > ih ? 'landscape' : 'portrait';
        };

        const updateViewportPanel = () => {
          const innerText = `${round(window.innerWidth)} x ${round(window.innerHeight)} px`;
          const visual = window.visualViewport;
          const visualText = visual
            ? `${round(visual.width)} x ${round(visual.height)} px`
            : '未対応';
          const dprText = (window.devicePixelRatio || 1).toFixed(2);
          const orientText = getOrientation();

          const elInner = document.getElementById('vv-inner');
          const elVisual = document.getElementById('vv-visual');
          const elDpr = document.getElementById('vv-dpr');
          const elOri = document.getElementById('vv-orientation');
          if (elInner) elInner.textContent = innerText;
          if (elVisual) elVisual.textContent = visualText;
          if (elDpr) elDpr.textContent = dprText;
          if (elOri) elOri.textContent = orientText;
        };

        const updateBox = (el) => {
          const w = el.clientWidth;
          const h = el.clientHeight;
          const text = `${round(w)} x ${round(h)} px`;
          const span = el.querySelector('.js-box-size');
          if (span) span.textContent = text;
        };

        const initBoxes = () => {
          const boxes = Array.from(document.querySelectorAll('.demo-item'));
          boxes.forEach(updateBox);

          if ('ResizeObserver' in window) {
            const ro = new ResizeObserver((entries) => {
              entries.forEach((entry) => {
                updateBox(entry.target);
              });
            });
            boxes.forEach((el) => ro.observe(el));
          } else {
            window.addEventListener('resize', () => {
              boxes.forEach(updateBox);
            });
          }
        };

        window.addEventListener('resize', updateViewportPanel);
        if (window.visualViewport) {
          window.visualViewport.addEventListener('resize', updateViewportPanel);
        }

        document.addEventListener('DOMContentLoaded', () => {
          updateViewportPanel();
          initBoxes();
        });
      })();
    </script>
  </body>
</html>
折りた




